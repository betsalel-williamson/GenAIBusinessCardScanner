---
title: 'Design Spec for Automated Vulnerability Scanning in CI'
project_name: 'monorepo'
epic_name: 'platform_engineering'
story_id: '00_platform_engineering/00_automated_vulnerability_scanning_in_ci'
spec_id: '00_platform_engineering/00_automated_vulnerability_scanning_in_ci/01_design_spec'
status: 'draft'
date_created: '2025-07-19T00:00:00-07:00'
date_approved: ''
touched: '*'
---

## 1. Objective

To integrate automated vulnerability scanning into the CI pipeline for Docker images to enhance the security posture of the application and build user trust.

## 2. Technical Design

This design proposes integrating Trivy, an open-source vulnerability scanner, into the GitHub Actions CI workflow. Trivy will scan the built Docker images for known vulnerabilities in OS packages and application dependencies. The CI pipeline will be configured to fail if vulnerabilities exceeding a predefined severity threshold (e.g., Critical or High) are detected.

### 2.1. Workflow Integration

The Trivy scan will be added as a new step in the `node-ci` job within `.github/workflows/ci.yml`, specifically after the Docker image for `validation_tool.ts` has been successfully built.

### 2.2. Trivy Action

We will utilize the `aquasecurity/trivy-action` GitHub Action for simplified integration. This action provides a convenient way to run Trivy scans and process their output within the CI environment.

### 2.3. Severity Thresholds

The scan will be configured to report and potentially fail the build based on vulnerability severity levels. Initially, we will focus on `CRITICAL` and `HIGH` severities as blocking issues.

### 2.4. Reporting

Scan results will be outputted to the GitHub Actions workflow logs. Consideration will be given to generating SARIF reports for integration with GitHub Security features if feasible and beneficial.

## 3. Key Changes

### 3.1. API Contracts

No changes to API contracts are required as this is an internal CI/CD enhancement.

### 3.2. Data Models

No changes to data models are required.

### 3.3. Component Responsibilities

* **GitHub Actions Workflow (`.github/workflows/ci.yml`):** Will be updated to include the Trivy scanning step.
* **Docker Images:** Will be subject to automated vulnerability scanning.

## 4. Alternatives Considered

* **Manual Scanning:** Rejected due to lack of automation, inconsistency, and potential for human error.
* **Other Scanning Tools:** Trivy was chosen for its ease of integration with GitHub Actions, comprehensive scanning capabilities (OS packages, application dependencies), and active community support.

## 5. Out of Scope

* Automated remediation of identified vulnerabilities.
* Scanning of non-Docker artifacts (e.g., source code static analysis).
* Integration with external security dashboards beyond GitHub Security features (if SARIF is implemented).
